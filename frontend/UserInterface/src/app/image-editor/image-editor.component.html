<div class="editor-container">
  <h2>Multi-Filter Image Editor</h2>

  <!-- Upload -->
  <div class="upload-section">
    <label>Select Image:</label>
    <input type="file" accept="image/*" (change)="onFileSelected($event)" />
  </div>

  <!-- K-means -->
  <div class="input-group">
    <label>Number of Clusters (K):</label>
    <input type="number" [(ngModel)]="kValue" min="2" />
  </div>

  <!-- Action Buttons -->
  <div class="action-buttons">
    <button (click)="applyFilter('grayscale')"      [disabled]="!workingImage">Grayscale</button>
    <button (click)="applyFilter('noise')"          [disabled]="!workingImage">Noise</button>
    <button (click)="applyFilter('histogram')"      [disabled]="!workingImage">Histogram</button>
    <button (click)="applyFilter('kmeans')"         [disabled]="!workingImage">K-Means</button>
    <button (click)="applyFilter('otsu')"           [disabled]="!workingImage">Otsu</button>
    <button (click)="applyFilter('canny')"          [disabled]="!workingImage">Canny</button>
    <button (click)="applyFilter('watershed')"      [disabled]="!workingImage">Watershed</button>
    <button (click)="applyFilter('measure-distance')" [disabled]="!workingImage">Measure Distance</button>
    <button (click)="resetWorkingImage()"           [disabled]="!workingImage">Reset</button>
  </div>

  <!-- Images + Overlay -->
  <div class="images-container" *ngIf="workingImage">
    <div class="image-block">
      <h3>Original Image</h3>
      <img [src]="originalImage" alt="Original" />
    </div>

    <div class="image-block click-container">
      <h3>Working Image</h3>
      <img
        #imageEl
        [src]="workingImage"
        [class.clickable]="measureMode"
        (load)="onImageLoad()"
        alt="Working"
      />
      <canvas
        #overlayCanvas
        class="overlay-canvas"
        (click)="onCanvasClick($event)"
      ></canvas>
    </div>

    <div *ngIf="measureMode" class="measure-info">
      Click exactly two points to measure distanceâ€¦
    </div>
    <div *ngIf="measuredDistance !== null" class="measure-info">
      <strong>Distance:</strong> {{ measuredDistance | number:'1.2-2' }} px
    </div>
  </div>
</div>
